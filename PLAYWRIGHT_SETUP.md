# ğŸ­ Playwright E2Eãƒ†ã‚¹ãƒˆ - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

## âœ… å°å…¥å®Œäº†ï¼

PlaywrightãŒæ­£å¸¸ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã—ãŸã€‚ä»¥ä¸‹ã®å†…å®¹ãŒè¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ï¼š

### ğŸ“¦ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
- `@playwright/test` (æœ€æ–°ç‰ˆ)
- Chromiumãƒ–ãƒ©ã‚¦ã‚¶

### ğŸ“ ä½œæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«
```
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ/
â”œâ”€â”€ playwright.config.ts          # Playwrightè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ .env.test.example             # ãƒ†ã‚¹ãƒˆç”¨ç’°å¢ƒå¤‰æ•°ã®ã‚µãƒ³ãƒ—ãƒ«
â”œâ”€â”€ e2e/                          # E2Eãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
â”‚   â”œâ”€â”€ signin.spec.ts           # ã‚µã‚¤ãƒ³ã‚¤ãƒ³æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ service.spec.ts          # ã‚µãƒ¼ãƒ“ã‚¹ãƒšãƒ¼ã‚¸ã®ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ navigation.spec.ts       # ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ responsive.spec.ts       # ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ã®ãƒ†ã‚¹ãƒˆ
â”‚   â””â”€â”€ README.md                # E2Eãƒ†ã‚¹ãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
â””â”€â”€ PLAYWRIGHT_SETUP.md          # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

---

## ğŸš€ ã™ãã«ä½¿ãˆã‚‹ï¼å®Ÿè¡Œæ–¹æ³•

### 1. ç’°å¢ƒå¤‰æ•°ã®è¨­å®šï¼ˆåˆå›ã®ã¿ï¼‰

```bash
# .env.test.example ã‚’ .env.test ã«ã‚³ãƒ”ãƒ¼
cp .env.test.example .env.test

# .env.test ã‚’ç·¨é›†ã—ã¦ã€å®Ÿéš›ã®ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¨­å®š
# TEST_EMAIL=your-test-email@example.com
# TEST_PASSWORD=YourTestPassword123
```

### 2. ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ

```bash
# ã™ã¹ã¦ã®E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
npm run test:e2e

# UIãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œï¼ˆãƒ‡ãƒãƒƒã‚°ã«æœ€é©ï¼ï¼‰
npm run test:e2e:ui

# ãƒ–ãƒ©ã‚¦ã‚¶ã‚’è¡¨ç¤ºã—ã¦å®Ÿè¡Œ
npm run test:e2e:headed

# ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆã‚’è¡¨ç¤º
npm run test:e2e:report
```

---

## ğŸ¯ Jestã¨ã®å…±å­˜ - ç«¶åˆã—ã¾ã›ã‚“ï¼

### ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«ã®æ£²ã¿åˆ†ã‘

| ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ« | ç”¨é€” | å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« | å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ |
|------------|------|------------|------------|
| **Jest** | ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ | `app/**/*.test.ts(x)` | `npm test` |
| **Playwright** | E2Eãƒ†ã‚¹ãƒˆ | `e2e/**/*.spec.ts` | `npm run test:e2e` |

### ãªãœç«¶åˆã—ãªã„ã®ã‹ï¼Ÿ

1. **ç•°ãªã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª**:
   - Jest: `app/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã® `*.test.ts(x)` ãƒ•ã‚¡ã‚¤ãƒ«
   - Playwright: `e2e/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã® `*.spec.ts` ãƒ•ã‚¡ã‚¤ãƒ«

2. **ç•°ãªã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**:
   - Jest: `jest.config.js`
   - Playwright: `playwright.config.ts`

3. **ç•°ãªã‚‹ãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼**:
   - Jest: Node.jsç’°å¢ƒã§ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ†ã‚¹ãƒˆ
   - Playwright: å®Ÿéš›ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ãƒ—ãƒªå…¨ä½“ã‚’ãƒ†ã‚¹ãƒˆ

### ä¸¡æ–¹ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆ

```bash
# ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
npm test

# E2Eãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
npm run test:e2e

# ã¾ãŸã¯ã€ä¸¡æ–¹ã‚’é †ç•ªã«å®Ÿè¡Œ
npm test && npm run test:e2e
```

---

## ğŸ“Š ä½œæˆã•ã‚ŒãŸãƒ†ã‚¹ãƒˆã®å†…å®¹

### 1. ã‚µã‚¤ãƒ³ã‚¤ãƒ³æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ (`e2e/signin.spec.ts`)
- âœ… æ­£å¸¸ç³»: æœ‰åŠ¹ãªèªè¨¼æƒ…å ±ã§ã‚µã‚¤ãƒ³ã‚¤ãƒ³ã§ãã‚‹
- âœ… ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®è¡¨ç¤º/éè¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹
- âœ… ç©ºæ¬„ã§ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒœã‚¿ãƒ³ãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹

### 2. ã‚µãƒ¼ãƒ“ã‚¹ãƒšãƒ¼ã‚¸ãƒ†ã‚¹ãƒˆ (`e2e/service.spec.ts`)
- âœ… ã‚µãƒ¼ãƒ“ã‚¹ãƒšãƒ¼ã‚¸ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ãƒãƒªã‚·ãƒ¼ã‚’é¸æŠã§ãã‚‹
- âœ… å‡¦ç†å±¥æ­´ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- â­ï¸ ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆç’°å¢ƒä¾å­˜ã®ãŸã‚ã‚¹ã‚­ãƒƒãƒ—ï¼‰

### 3. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ (`e2e/navigation.spec.ts`)
- âœ… æœªèªè¨¼ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ä¿è­·ã•ã‚ŒãŸãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„
- âœ… è¨€èªåˆ‡ã‚Šæ›¿ãˆãŒæ©Ÿèƒ½ã™ã‚‹
- âœ… ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã‹ã‚‰ä¸»è¦ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ãŒæ©Ÿèƒ½ã™ã‚‹
- âœ… ã‚µã‚¤ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰å„ãƒšãƒ¼ã‚¸ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
- âœ… ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆãŒæ©Ÿèƒ½ã™ã‚‹

### 4. ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ (`e2e/responsive.spec.ts`)
- âœ… ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—è¡¨ç¤ºãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- âœ… ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆè¡¨ç¤ºãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- âœ… ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤ºãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- âœ… ãƒ¢ãƒã‚¤ãƒ«ã§ãƒãƒ³ãƒãƒ¼ã‚¬ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹

---

## ğŸ”§ è¨­å®šã®è©³ç´°

### `playwright.config.ts` ã®ä¸»ãªè¨­å®š

```typescript
{
  testDir: './e2e',                    // ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
  fullyParallel: true,                 // å®Œå…¨ä¸¦åˆ—å®Ÿè¡Œ
  retries: process.env.CI ? 2 : 0,     // CIç’°å¢ƒã§ã¯2å›ãƒªãƒˆãƒ©ã‚¤
  workers: process.env.CI ? 2 : undefined, // ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°
  baseURL: 'http://localhost:3000',    // ãƒ™ãƒ¼ã‚¹URL
  
  // è‡ªå‹•çš„ã«é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
  webServer: {
    command: 'npm run dev',
    url: 'http://localhost:3000',
    reuseExistingServer: !process.env.CI,
  },
}
```

### ä¸»ãªæ©Ÿèƒ½

1. **è‡ªå‹•å¾…æ©Ÿ**: è¦ç´ ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§è‡ªå‹•çš„ã«å¾…æ©Ÿ
2. **è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤**: å¤±æ•—ã—ãŸãƒ†ã‚¹ãƒˆã‚’è‡ªå‹•çš„ã«ãƒªãƒˆãƒ©ã‚¤ï¼ˆCIç’°å¢ƒï¼‰
3. **ä¸¦åˆ—å®Ÿè¡Œ**: è¤‡æ•°ã®ãƒ†ã‚¹ãƒˆã‚’åŒæ™‚ã«å®Ÿè¡Œã—ã¦é«˜é€ŸåŒ–
4. **ãƒˆãƒ¬ãƒ¼ã‚¹è¨˜éŒ²**: å¤±æ•—æ™‚ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã€ãƒ“ãƒ‡ã‚ªã€ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è‡ªå‹•ä¿å­˜
5. **é–‹ç™ºã‚µãƒ¼ãƒãƒ¼è‡ªå‹•èµ·å‹•**: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚ã«è‡ªå‹•çš„ã« `npm run dev` ã‚’å®Ÿè¡Œ

---

## ğŸ› ãƒ‡ãƒãƒƒã‚°æ–¹æ³•

### 1. UIãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œï¼ˆæ¨å¥¨ï¼‰

```bash
npm run test:e2e:ui
```

**ã§ãã‚‹ã“ã¨**:
- ãƒ†ã‚¹ãƒˆã‚’ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã§å®Ÿè¡Œ
- å„ã‚¹ãƒ†ãƒƒãƒ—ã®ç”»é¢ã‚’ç¢ºèª
- è¦ç´ ã®ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã‚’ç¢ºèª
- ã‚¿ã‚¤ãƒ ãƒˆãƒ©ãƒ™ãƒ«ãƒ‡ãƒãƒƒã‚°

### 2. ãƒ–ãƒ©ã‚¦ã‚¶ã‚’è¡¨ç¤ºã—ã¦å®Ÿè¡Œ

```bash
npm run test:e2e:headed
```

**ã§ãã‚‹ã“ã¨**:
- ãƒ–ãƒ©ã‚¦ã‚¶ã®å‹•ãã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç¢ºèª
- é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒãƒƒã‚°

### 3. ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã®ã¿å®Ÿè¡Œ

```bash
# ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆã®ã¿
npx playwright test e2e/signin.spec.ts

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®ã¿
npx playwright test -g "æ­£å¸¸ç³»"
```

### 4. ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ“ãƒ¥ãƒ¼ã‚¢ãƒ¼ã§åˆ†æ

```bash
# ãƒˆãƒ¬ãƒ¼ã‚¹ä»˜ãã§å®Ÿè¡Œ
npx playwright test --trace on

# ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è¡¨ç¤º
npm run test:e2e:report
```

---

## ğŸ“ ãƒ†ã‚¹ãƒˆã®æ›¸ãæ–¹

### åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆæ§‹é€ 

```typescript
import { test, expect } from '@playwright/test';

test.describe('æ©Ÿèƒ½å', () => {
  test('ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å', async ({ page }) => {
    // 1. ãƒšãƒ¼ã‚¸ã«ç§»å‹•
    await page.goto('/ja/signin');
    
    // 2. è¦ç´ ã‚’æ“ä½œ
    await page.fill('[name="email"]', 'test@example.com');
    await page.click('button[type="submit"]');
    
    // 3. çµæœã‚’æ¤œè¨¼
    await expect(page).toHaveURL(/\/ja\/account/);
  });
});
```

### ã‚ˆãä½¿ã†API

```typescript
// ãƒšãƒ¼ã‚¸æ“ä½œ
await page.goto('/path');
await page.fill('input', 'value');
await page.click('button');
await page.selectOption('select', 'option');

// å¾…æ©Ÿ
await page.waitForURL(/pattern/);
await page.waitForSelector('h1');
await page.waitForLoadState('networkidle');

// ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³
await expect(page).toHaveURL(/pattern/);
await expect(page.locator('h1')).toBeVisible();
await expect(page.locator('h1')).toContainText('ãƒ†ã‚­ã‚¹ãƒˆ');
await expect(page.locator('button')).toBeDisabled();
```

---

## ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### 1. ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã‚‹

```bash
npm run test:e2e:ui
```

### 2. å®Ÿéš›ã®ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã§å‹•ä½œç¢ºèª

`.env.test` ã«å®Ÿéš›ã®ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¨­å®šã—ã¦ã€ãƒ†ã‚¹ãƒˆãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚

### 3. ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã™ã‚‹

`e2e/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«æ–°ã—ã„ `*.spec.ts` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã€ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã§ãã¾ã™ã€‚

### 4. CI/CDã«çµ„ã¿è¾¼ã‚€

GitHub Actionsãªã©ã§è‡ªå‹•å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«è¨­å®šã§ãã¾ã™ã€‚

---

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [Playwrightå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://playwright.dev/)
- [Playwright Test API](https://playwright.dev/docs/api/class-test)
- [Best Practices](https://playwright.dev/docs/best-practices)
- [E2Eãƒ†ã‚¹ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](./E2E_TEST_CHECKLIST.md)

---

## â“ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹å ´åˆ

1. **é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª**
   ```bash
   npm run dev
   ```

2. **ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª**
   - `.env.test` ã®èªè¨¼æƒ…å ±ãŒæ­£ã—ã„ã‹ç¢ºèª

3. **ãƒ–ãƒ©ã‚¦ã‚¶ã‚’è¡¨ç¤ºã—ã¦å®Ÿè¡Œ**
   ```bash
   npm run test:e2e:headed
   ```

4. **ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ç¢ºèª**
   ```bash
   npm run test:e2e:report
   ```

### ãã®ä»–ã®å•é¡Œ

- [Playwright Troubleshooting](https://playwright.dev/docs/troubleshooting)
- [Playwright Discord](https://aka.ms/playwright/discord)

---

**ğŸ‰ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ï¼E2Eãƒ†ã‚¹ãƒˆã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼**

